# 실행 컨텍스트 (Execution Contect)

컨텍스트 = 문맥이라고 생각하면 편할 것 같다.

- **Javascript 코드가 실행되고 있는 컨텍스트 (환경)**
- 실행 컨텍스트는 실행할 코드에 제공할 환경 정보들을 (변수 정보들) 모아 놓는 환경이다.
- `함수를 실행할 때마다`, 그 함수에 새로운 실행 컨텍스트를 `생성`하여 자신만의 고유한 컨텍스트에서 실행된다.

## 실행 컨텍스트가 모아놓는 정보

- 코드를 실행하기 위한 여러가지 정보
- 예를 들어, 어떤 변수가 있는지, 어떤 변수를 호이스팅할지, 스코프는 어떻고, 스코프 체인은 어떻고, this는 어디에 어떻게 바인딩 되는지 등등의 정보를 모두 가지고 있다.

## 실행 컨텍스트가 생성되는 시점
 
- 하나의 자바스크립트 파일을 실행할 때, 필요한 환경 정보를 모아 컨텍스트를 구성하고, `call stack` 에 쌓아 올렸다가, 가장 위의 컨텍스트와 관련있는 코드를 실행하는 식으로 전체 코드의 환경과 순서를 보장한다
- 예: react에서 수 많은 자바스크립트 파일을 만들고 맨 마지막에 npm start 하면, 하나의 자바스크립트 파일로 통합되면서 브라우저에서 실행될 때 

> 콜스택 `call stack`
> 현재 실행 중인 서버루틴(작업)에 대한 정보를 저장하는 stack 자료구조

## 실행할 코드

### 1. 전역코드

- 전역 영역에 존재하는 코드는 `전역 컨텍스트`가 생성된다.
- 전역이라는 공간은 단 하나이기 때문에, 콜스택에 전역 컨텍스트는 하나 뿐이다.
- 자바스크립트 파일이 실행하자마자 전역 컨텍스트부터 활성화한다.
- 실행 컨텍스트를 구성하는 콜스택에 가장 먼저 들어와 가장 밑 바닥에서, 자바스크립트 파일이 열리자마자 제일 먼저 전역으로 실행할 코드에 대한 정보를 담아 놓는다.

### 2. 함수 코드

- 함수 내에 존재하는 코드를 실행하기 위한 `함수 컨텍스트`
- 함수가 실행될 때마다 함수 컨텍스트가 실행되서 쌓이게 된다

### 3. eval 코드

- 자바스크립트의 내장 함수로, eval 함수로 실행되는 코드를 위한 `eval 컨텍스트`
- 요즘에는 거의 쓰이지 않기 때문에 있다는 것만 확인하고 넘어가면 될 것 같다

## 콜스택 구조

### 컨텍스트가 쌓이는 순서

1. 자바스크립트 파일이 열리자마자 (=브라우저에서 실행할 준비를 하자마자), 전역 컨텍스트 쌓이고
2. outer 함수 컨텍스트 쌓이면서 내부의 내용을 확인해보니,
3. inner 함수 컨텍스트 쌓인다

### 컨텍스트가 빠지는 순서

1. 함수가 실행될 때마다 컨텍스트가 하나씩 빠지게 되는데,
2. 전역컨텍스트는 브라우저가 종료될 때 (=탭이 꺼질 때) 없어지게 되면서
3. 모든 자바스크립트의 함수가 실행되고 브라우저가 종료되면 콜스택에 있는 컨텍스트는 모두 없어지는 구조이다.

이러한 콜스택 구조로 인해, 함수의 실행순서가 보장된다.

```javascript
function outer() {
	function inner() {
    	return 'inner 함수';
    }
  
  	inner();
}

outer();
```

![](https://www.notion.so/image/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F75547d85-489f-46d3-a5b7-8b73f196d81b%2FIMG_4401.heic?table=block&id=c61bedf3-4865-42c0-b72c-57405a39a492&spaceId=4b97eaca-7938-4c43-b27c-a0c55795a841&width=2000&userId=1ca64008-6c1c-4524-b0fe-593d7a3e905d&cache=v2)

## 컨텍스트에 담기는 정보

간단히 변수의 참조를 기록하는 환경
일단 3가지만 정리해보자

### VariableEnvironment

- 변수객체 (Variable Object) 라고도 한다
- LexicalEnvironment을 본따놓은 하나의 `스냅샷`이라고 한다 

### ⭐️ LexicalEnvironment

실행컨텍스트도 하나의 객체로서, 객체 안에 정보가 다 있기 때문에 변수, 매개변수, 인자, 함수 선언 등의 정보가 있다.

1. Environment record
  - 변수와 함수 선언 등을 저장한다 : 변수, 매개변수, 인자, 함수 선언 등의 정보
  - 코드가 실행되기 전에 정보를 모두 수집한다 : 자바스크립트 엔진은 실행되기 전에 코드의 변수명을 모두 알고 있다는 것 `Hoisting`
  
  > #### 호이스팅 (Hoisting)
  - 함수 컨텍스트가 콜스택 안에 딱 들어와서 실행되기 전에 이 함수 안에서 사용되는 변수와 같은 정보들을 모두 알고 있는 것
  - 호이스트가 끌어올린다는 말 뜻처럼, 중간에 선언되는 것들을 맨 처음에 실행된다

2. Outer
   - 스코프 체이닝에 대한 정보를 담고 있다.
   - 실행 컨텍스트에서 작업을 끝내고 `다른 변수` (함수 내부 말고, 다른 함수에서 선언된 변수) 를 참조할 수 있도록 정보를 가지고 있는 것
  
### ⭐️ ThisBinding
